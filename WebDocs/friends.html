<!DOCTYPE html>
<html>
    <head>
        <title>Bootstrap 3</title>
        <meta name="viewport" content="width=device-width", initial-scale=1.0">
        <link href ="css/bootstrap.min.css" rel ="stylesheet">
        <link href="css/styles.css" rel="stylesheet">
    </head>
    <body>
	<script>
	function visitPage(id){
        window.location.assign("friend_profile.html?id=" + id);
    }
	
   // This is called with the results from from FB.getLoginStatus().
   function statusChangeCallback(response) {
     console.log('statusChangeCallback');
     console.log(response);
     // The response object is returned with a status field that lets the
     // app know the current login status of the person.
     // Full docs on the response object can be found in the documentation
     // for FB.getLoginStatus().
     if (response.status === 'connected') {
       // Logged into your app and Facebook.
       testAPI();
     } else {
       // The person is not logged into your app or we are unable to tell.
       // document.getElementById('status').innerHTML = 'Please log ' +
       //   'into this app.';
       //redirect to login page
       window.location.replace("fb_login_page.html");
     }
   }
 
   // This function is called when someone finishes with the Login
   // Button.  See the onlogin handler attached to it in the sample
   // code below.
   function checkLoginState() {
     FB.getLoginStatus(function(response) {
       statusChangeCallback(response);
     });
   }
 
   window.fbAsyncInit = function() {
   FB.init({
     appId      : '218882488583601',
     cookie     : true,  // enable cookies to allow the server to access 
                         // the session
     xfbml      : true,  // parse social plugins on this page
     version    : 'v2.8' // use graph api version 2.8
   });
 
   // Now that we've initialized the JavaScript SDK, we call 
   // FB.getLoginStatus().  This function gets the state of the
   // person visiting this page and can return one of three states to
   // the callback you provide.  They can be:
   //
   // 1. Logged into your app ('connected')
   // 2. Logged into Facebook, but not your app ('not_authorized')
   // 3. Not logged into Facebook and can't tell if they are logged into
   //    your app or not.
   //
   // These three cases are handled in the callback function.
 
   FB.getLoginStatus(function(response) {
     statusChangeCallback(response);
   });
   };
 
   // Load the SDK asynchronously
   (function(d, s, id) {
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) return;
     js = d.createElement(s); js.id = id;
     js.src = "//connect.facebook.net/en_US/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
 
   // Here we run a very simple test of the Graph API after login is
   // successful.  See statusChangeCallback() for when this call is made.
   function testAPI() {
     console.log('Welcome!  Fetching your information.... ');
     FB.api('/me', function(response) {
       console.log('Successful login for: ' + response.name);
       console.log("response:");
       console.log(response);
       //Get friend list of user
       /* make the API call */
       FB.api(
           "/me/friends",
           function (response) {
             console.log("friendlists call:");
             if (response && !response.error) {
               /* handle the result */
               console.log("Successful");
               console.log(response);
			   var numFriends = response.length;
			   var rowNUM = 1;
			   var rowID = "row" + rowNUM;
			   var rowData = document.createElement("div");
			   rowData.id = rowID;
			   rowData.class = "row top-buffer";
			   //"<div class=\"row top-buffer\" id=\"" + rowID + "\"></div>";
			   document.getElementById('friends').appendChild(rowData);
			   var spacer = document.createElement("div");
			   spacer.class = "col-md-1";
			   var i;
			   for(i = 0; i < numFriends; i++){
			      if(i != 0 && i % 3 == 0){// add new row
					rowNUM++;
					rowID = "row" + rowNUM;
					rowData = document.createElement("div");
					rowData.id = rowID;
					rowData.class = "row top-buffer";
					document.getElementById('friends').appendChild(rowData);
				  }
				  else if(i % 3 != 0){// add spacer
					document.getElementById(rowID).appendChild(spacer);
				  }
				  var friendData = document.createElement("div");
			      friendData.id = "friend" + i;
			      friendData.className = "col-md-3";
			      friendData.innerHTML = "<h1 align=\"center\">" + repsonse[i].name +
				  "</h1><center><img src=\"" + "http://graph.facebook.com/" + response[i].id + "/picture?type=large" + 
				  "\" class=\"img-responsive\" alt=\"Cinque Terre\" width=\"304\" height=\"600\"></center>" +
				  "<button onclick=\"visitPage(" + response[i].id + ");\">View " + repsonse[i].name + "'s profile</button>";
				  document.getElementById(rowID).appendChild(friendData);
			   }
             }
             if(response.error){
               console.log("Error");
               console.log(response.error);
             }
           }
       );
     });
   }
 </script>
    <div class = "navbar navbar-inverse navbar-static-top">
            <div class="container">
                <a href="#" class= "navbar-brand">Preferate</a>

                <button class ="navbar-toggle" data-toggle ="collapse" data-target=".navHeaderCollapse">
                    <span class = "icon-bar"></span>
                    <span class = "icon-bar"></span>
                    <span class = "icon-bar"></span>
                </button>

                <div class= "collapse navbar-collapse navHeaderCollapse">

                    <ul class = "nav navbar-nav navbar-right">
                        <li class="visited"><a href= "index.html">Home</a></li>
                        <li class="active"><a href= "friends.html">Friends</a></li>
                        <li class="visited"><a href= "preferences_page.html">Preferences</a></li>
                        <li class="visited"><a href= "review_page.html">Reviews</a></li> 
                        <li class="visited"><a href= "suggestions_page.html">Suggestions</a></li>
                    </ul>
                </div> 
            </div>
        </div> 
        <div class= "container" id="friends">
            <!-- <div class="row top-buffer" id="review_row">
                <div class="col-md-3" id="review1">
                    <h1 align="center">Friend1</h1>
                    <center><img src="user-default.png" class="img-responsive" alt="Cinque Terre" width="304" height="600"></center>
                </div>
                <div class="col-md-1"></div>
                <div class="col-md-3" id="review2">
                    <h1 align="center" >Friend2</h1>
                    <center><img src="user-default.png" class="img-responsive" alt="Cinque Terre" width="304" height="600"></center>
                </div>
                <div class="col-md-1"></div>
                <div class="col-md-3" id="review3">
                    <h1 align="center">Friend3</h1>
                    <center><img src="user-default.png" class="img-responsive" alt="Cinque Terre" width="304" height="600"></center>
                </div>
            </div>-->
        </div>

 
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
        <script src="js/bootstrap.js"></script> 
<!--        <script src="js/jquery-1.9.1.min.js"></script>
        <script src="js/bootstrap.js"></script> -->
    </body>

</html>